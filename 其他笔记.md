# React + Vite

This template provides a minimal setup to get React working in Vite with HMR and some ESLint rules.

Currently, two official plugins are available:

- [@vitejs/plugin-react](https://github.com/vitejs/vite-plugin-react/blob/main/packages/plugin-react/README.md) uses [Babel](https://babeljs.io/) for Fast Refresh
- [@vitejs/plugin-react-swc](https://github.com/vitejs/vite-plugin-react-swc) uses [SWC](https://swc.rs/) for Fast Refresh

## Expanding the ESLint configuration

If you are developing a production application, we recommend using TypeScript and enable type-aware lint rules. Check out the [TS template](https://github.com/vitejs/vite/tree/main/packages/create-vite/template-react-ts) to integrate TypeScript and [`typescript-eslint`](https://typescript-eslint.io) in your project.

## B站icon和svg

https://www.svgrepo.com/svg/345504/bilibili

去B站首页的CSS，找到品牌色：`#00AEEC`

下载后，发现大小是`512*512`，用画图3D调整图片大小为`128*128`。



TODO:

1. 有Base64数据后，打开对话框很慢
2. 打包优化
3. 展示下载进度条
4. 提供仪表盘，展示最后得到的视频标题、`INITIAL_STATE`、`window.location.href`和`window.__playinfo__`（JSON格式）
5. 不是B站就不要右键菜单添加
6. 默认文件名改成当前日期
7. 插件UI下方加一个footer，footer加上copyright
8. 黑暗模式
9. 番剧页面的样式有问题。https://www.bilibili.com/bangumi/play/ep1522606
10. 番剧页面的代码要求我们改用**Babel AST**来分析代码，而且`window.__playinfo__`的数据结构也和视频详情页不同。如下文`bangumi.js`所示。另外，限免集和会员集的数据结构也不一样。限免集是有`video_info.dash`的，仍然给你视频和音频的m4s；会员集则只有`video_info.durls`，直接给你mp4文件。



`bangumi.js`

```js
const playurlSSRData = {}
if (playurlSSRData) {
    if (true) {
        window.__playinfo__ = playurlSSRData
        config.prefetch = {
            playUrl: playurlSSRData,
        }
        const nanoPlayer = window.nano.createPlayer(config)
        window.player = nanoPlayer
        nanoPlayer.connect()
    }
}
```

